<view class="container">
  <view class="header">
    <view class="baby-info">
      <image class="avatar" src="{{currentBaby.avatarUrl || ''}}" mode="aspectFill" wx:if="{{currentBaby.avatarUrl}}"></image>
      <view class="avatar placeholder" wx:else>ğŸ‘¶</view>
      <view class="text-info">
        <text class="name">{{currentBaby.name}}</text>
        <text class="age">{{ageStr}}</text>
      </view>
    </view>
  </view>

  <!-- èº«ä½“æ•°æ®å¡ç‰‡ -->
  <view class="section-title">èº«ä½“æ•°æ®</view>
  <view class="card growth-card">
    <view class="stat-row">
      <view class="stat-item">
        <text class="label">èº«é«˜ (cm)</text>
        <text class="value">{{height || '--'}}</text>
        <text class="standard">æ ‡å‡†: {{growthStandard.height}}</text>
      </view>
      <view class="divider"></view>
      <view class="stat-item">
        <text class="label">ä½“é‡ (kg)</text>
        <text class="value">{{weight || '--'}}</text>
        <text class="standard">æ ‡å‡†: {{growthStandard.weight}}</text>
      </view>
    </view>
    <view class="card-action" bindtap="addGrowthRecord">
      <text>+ è®°å½•æ•°æ®</text>
    </view>
  </view>

  <!-- é‡Œç¨‹ç¢‘æ—¶é—´è½´ -->
  <view class="section-title">æˆé•¿é‡Œç¨‹ç¢‘</view>
  <view class="timeline">
    <view class="timeline-line"></view>
    
    <view class="timeline-item add-btn" bindtap="addMilestone">
      <view class="dot plus">+</view>
      <view class="content simple">
        <text>è®°å½•æ–°é‡Œç¨‹ç¢‘</text>
      </view>
    </view>
    <block wx:for="{{milestones}}" wx:key="id">
      <view class="timeline-item">
        <view class="dot"></view>
        <view class="content">
          <view class="date-tag">{{item.date}}</view>
          <text class="title">{{item.title}}</text>
          <text class="desc" wx:if="{{item.description}}">{{item.description}}</text>
          <image wx:if="{{item.photoLocalPath || item.photoFileId}}" src="{{item.photoLocalPath || item.photoFileId}}" mode="widthFix" class="photo"></image>
        </view>
      </view>
    </block>
  </view>

  <!-- Growth Record Modal -->
  <view class="modal-mask" wx:if="{{showGrowthModal}}">
    <view class="modal-content">
      <view class="modal-header">è®°å½•èº«ä½“æ•°æ®</view>
      <view class="form-item">
        <text class="label">æ—¥æœŸ</text>
        <picker mode="date" value="{{inputDate}}" bindchange="onDateChange">
          <view class="picker-input">{{inputDate}}</view>
        </picker>
      </view>
      <view class="form-item">
        <text class="label">èº«é«˜ (cm)</text>
        <input class="input" type="digit" placeholder="è¯·è¾“å…¥èº«é«˜" value="{{inputHeight}}" bindinput="onHeightInput" />
      </view>
      <view class="form-item">
        <text class="label">ä½“é‡ (kg)</text>
        <input class="input" type="digit" placeholder="è¯·è¾“å…¥ä½“é‡" value="{{inputWeight}}" bindinput="onWeightInput" />
      </view>
      <view class="modal-actions">
        <button class="btn cancel" bindtap="cancelGrowth">å–æ¶ˆ</button>
        <button class="btn confirm" bindtap="saveGrowth">ä¿å­˜</button>
      </view>
    </view>
  </view>

  <!-- Milestone Modal -->
  <view class="modal-mask" wx:if="{{showMilestoneModal}}">
    <view class="modal-content">
      <view class="modal-header">å‘å¸ƒé‡Œç¨‹ç¢‘</view>
      <view class="form-item">
        <text class="label">æ—¥æœŸ</text>
        <picker mode="date" value="{{inputMilestoneDate}}" bindchange="onMilestoneDateChange">
          <view class="picker-input">{{inputMilestoneDate}}</view>
        </picker>
      </view>
      <view class="form-item">
        <text class="label">æ ‡é¢˜</text>
        <input class="input" placeholder="ä¾‹å¦‚ï¼šç¬¬ä¸€æ¬¡ç¿»èº«" value="{{inputTitle}}" bindinput="onTitleInput" />
      </view>
      <view class="form-item">
        <text class="label">æè¿°</text>
        <textarea class="textarea" placeholder="è®°å½•è¿™éš¾å¿˜çš„ä¸€åˆ»..." value="{{inputDesc}}" bindinput="onDescInput"></textarea>
      </view>
      <view class="form-item photo-upload" bindtap="choosePhoto">
        <image wx:if="{{inputPhotoPath}}" src="{{inputPhotoPath}}" mode="aspectFill" class="preview"></image>
        <view wx:else class="upload-placeholder">
          <text class="icon">+</text>
          <text>æ·»åŠ ç…§ç‰‡</text>
        </view>
      </view>
      <view class="modal-actions">
        <button class="btn cancel" bindtap="cancelMilestone">å–æ¶ˆ</button>
        <button class="btn confirm" bindtap="saveMilestone">å‘å¸ƒ</button>
      </view>
    </view>
  </view>
</view>
