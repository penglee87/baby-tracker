<view class="container">
  <view class="header-section">
    <text class="page-title">宝宝管理</text>
    <text class="page-desc">管理宝宝档案，切换当前记录对象</text>
  </view>

  <!-- Current Baby Card -->
  <view class="section-label">当前宝宝</view>
  <view class="card current-card">
    <view class="card-body">
      <view class="avatar-container">
        <image wx:if="{{currentBaby.avatarUrl}}" class="avatar" src="{{currentBaby.avatarUrl}}" mode="aspectFill" />
        <view wx:else class="avatar placeholder">👶</view>
      </view>
      <view class="info-container">
        <view class="name-row">
          <text class="baby-name">{{currentBaby.name || '未命名宝宝'}}</text>
          <view class="status-tag">当前</view>
        </view>
        <text class="baby-id">共享码：{{currentBaby.id || '未知'}}</text>
      </view>
      <view class="action-container">
        <view class="icon-btn" bindtap="openEdit" data-id="{{currentBaby.id}}">
          <text class="btn-icon">✎</text>
          <text class="btn-label">编辑</text>
        </view>
        <view class="icon-btn" bindtap="deleteBaby" data-id="{{currentBaby.id}}">
          <text class="btn-icon danger">🗑</text>
          <text class="btn-label danger">删除</text>
        </view>
      </view>
    </view>
  </view>

  <!-- Other Babies List -->
  <block wx:if="{{otherBabies.length > 0}}">
    <view class="section-label">其他宝宝</view>
    <view class="baby-list">
      <block wx:for="{{otherBabies}}" wx:key="id">
        <view class="card list-item" wx:if="{{item.id}}">
          <view class="card-body">
            <view class="avatar-container small">
              <image wx:if="{{item.avatarUrl}}" class="avatar" src="{{item.avatarUrl}}" mode="aspectFill" />
              <view wx:else class="avatar placeholder">👶</view>
            </view>
            <view class="info-container">
              <text class="baby-name small">{{item.name || '未命名宝宝'}}</text>
              <text class="baby-id">共享码：{{item.id}}</text>
            </view>
            <view class="list-actions">
              <button class="action-btn switch" size="mini" bindtap="setCurrent" data-id="{{item.id}}">切换</button>
              <view class="icon-actions">
                <view class="icon-circle-btn" bindtap="openEdit" data-id="{{item.id}}">
                  <text>✎</text>
                </view>
                <view class="icon-circle-btn danger" bindtap="deleteBaby" data-id="{{item.id}}">
                  <text>🗑</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>
  </block>

  <view class="footer-spacer"></view>
  
  <view class="floating-footer">
    <button class="main-btn" bindtap="openCreate">
      <text class="plus-icon">+</text> 新增宝宝
    </button>
  </view>

  <!-- Edit/Create Modal -->
  <view class="overlay" wx:if="{{showEditModal}}">
    <view class="modal">
      <view class="modal-header">
        <text class="modal-title">{{isCreate ? '新增宝宝' : '编辑宝宝'}}</text>
      </view>
      <view class="modal-content">
        <view class="form-item" wx:if="{{isCreate}}">
          <text class="label">共享码 <text class="desc">(唯一标识)</text></text>
          <input class="input" placeholder="例如: family-001" bindinput="onEditIdInput" value="{{editId}}" />
        </view>
        <view class="form-item">
          <text class="label">宝宝昵称</text>
          <input class="input" placeholder="例如: 小宝" bindinput="onEditNameInput" value="{{editName}}" />
        </view>
        <view class="form-item">
          <text class="label">性别</text>
          <radio-group class="gender-group" bindchange="onEditGenderChange">
            <label class="radio-label">
              <radio value="boy" checked="{{editGender === 'boy'}}" color="#9F85FF"/> 男宝
            </label>
            <label class="radio-label">
              <radio value="girl" checked="{{editGender === 'girl'}}" color="#FF85C0"/> 女宝
            </label>
          </radio-group>
        </view>
        <view class="form-item">
          <text class="label">出生日期</text>
          <picker mode="date" value="{{editBirthday}}" bindchange="onEditBirthdayChange">
             <view class="picker-input {{editBirthday ? '' : 'placeholder'}}">
               {{editBirthday || '请选择出生日期'}}
             </view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">头像</text>
          <view class="avatar-selector" bindtap="chooseAvatar">
            <image wx:if="{{editAvatarUrl}}" class="avatar-preview" src="{{editAvatarUrl}}" mode="aspectFill" />
            <view wx:else class="avatar-preview placeholder">📷</view>
            <text class="select-hint">点击更换头像</text>
          </view>
        </view>
      </view>
      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="cancelEdit">取消</button>
        <button class="modal-btn confirm" bindtap="saveEdit">保存</button>
      </view>
    </view>
  </view>
</view>
